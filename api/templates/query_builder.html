<!-- @format -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Query Builder - EcoMetrics</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Space+Grotesk:wght@500;600;700&family=JetBrains+Mono:wght@400;500&display=swap"
      rel="stylesheet"
    />
    <style>
      :root {
        --primary: #10b981;
        --primary-dark: #059669;
        --primary-light: #d1fae5;
        --secondary: #0ea5e9;
        --dark: #1e293b;
        --darker: #0f172a;
        --light: #f8fafc;
        --gray: #64748b;
        --gray-light: #94a3b8;
        --card-bg: #ffffff;
        --gradient: linear-gradient(135deg, #10b981 0%, #0ea5e9 100%);
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Inter", -apple-system, BlinkMacSystemFont, sans-serif;
        background: linear-gradient(135deg, #f0fdf4 0%, #e0f2fe 100%);
        color: var(--dark);
        line-height: 1.6;
        min-height: 100vh;
      }

      /* Navigation */
      .nav {
        background: var(--card-bg);
        border-bottom: 1px solid #e2e8f0;
        padding: 1rem 2rem;
        position: sticky;
        top: 0;
        z-index: 100;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
      }

      .nav-content {
        max-width: 1400px;
        margin: 0 auto;
        display: flex;
        align-items: center;
        justify-content: space-between;
      }

      .nav-logo {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        text-decoration: none;
      }

      .nav-logo-icon {
        width: 40px;
        height: 40px;
        background: var(--gradient);
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.25rem;
      }

      .nav-logo-text {
        font-family: "Space Grotesk", sans-serif;
        font-size: 1.25rem;
        font-weight: 700;
        background: var(--gradient);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      .nav-links {
        display: flex;
        gap: 1.5rem;
      }

      .nav-links a {
        color: var(--gray);
        text-decoration: none;
        font-weight: 500;
        font-size: 0.95rem;
        transition: color 0.2s;
      }

      .nav-links a:hover {
        color: var(--primary);
      }

      /* Layout */
      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 2rem;
      }

      /* Header */
      .page-header {
        text-align: center;
        padding: 3rem 0 2rem;
      }

      .page-header h1 {
        font-family: "Space Grotesk", sans-serif;
        font-size: 2.5rem;
        color: var(--dark);
        margin-bottom: 0.75rem;
      }

      .page-header p {
        color: var(--gray);
        font-size: 1.1rem;
      }

      /* Card */
      .card {
        background: var(--card-bg);
        border-radius: 16px;
        padding: 2rem;
        margin-bottom: 1.5rem;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05),
          0 2px 4px -1px rgba(0, 0, 0, 0.03);
        border: 1px solid #e2e8f0;
      }

      .card-title {
        font-family: "Space Grotesk", sans-serif;
        font-size: 1.25rem;
        color: var(--dark);
        margin-bottom: 1.5rem;
        display: flex;
        align-items: center;
        gap: 0.75rem;
      }

      .card-title::before {
        content: "";
        width: 4px;
        height: 24px;
        background: var(--gradient);
        border-radius: 2px;
      }

      /* Form Elements */
      .form-group {
        margin-bottom: 1.5rem;
      }

      .form-label {
        display: block;
        font-weight: 500;
        color: var(--dark);
        margin-bottom: 0.5rem;
        font-size: 0.95rem;
      }

      select {
        width: 100%;
        max-width: 300px;
        padding: 0.75rem 1rem;
        border: 1px solid #e2e8f0;
        border-radius: 10px;
        font-family: "Inter", sans-serif;
        font-size: 0.95rem;
        background: white;
        color: var(--dark);
        cursor: pointer;
        transition: border-color 0.2s, box-shadow 0.2s;
      }

      select:focus {
        outline: none;
        border-color: var(--primary);
        box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
      }

      input[type="text"] {
        padding: 0.625rem 0.875rem;
        border: 1px solid #e2e8f0;
        border-radius: 8px;
        font-family: "JetBrains Mono", monospace;
        font-size: 0.9rem;
        transition: border-color 0.2s, box-shadow 0.2s;
        width: 100%;
        max-width: 120px;
      }

      input[type="text"]:focus {
        outline: none;
        border-color: var(--primary);
        box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
      }

      /* Flex Layout */
      .flex-parent {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1.5rem;
      }

      .flex-child {
        background: #f8fafc;
        border: 1px solid #e2e8f0;
        border-radius: 12px;
        padding: 1.25rem;
      }

      .flex-child p {
        font-weight: 600;
        color: var(--dark);
        margin-bottom: 0.75rem;
        font-size: 0.9rem;
      }

      /* Checkbox List */
      .checkbox-list {
        list-style: none;
        max-height: 300px;
        overflow-y: auto;
        padding-right: 0.5rem;
      }

      .checkbox-list::-webkit-scrollbar {
        width: 6px;
      }

      .checkbox-list::-webkit-scrollbar-track {
        background: #f1f5f9;
        border-radius: 3px;
      }

      .checkbox-list::-webkit-scrollbar-thumb {
        background: #cbd5e1;
        border-radius: 3px;
      }

      .checkbox-list::-webkit-scrollbar-thumb:hover {
        background: #94a3b8;
      }

      .checkbox-list li {
        padding: 0.375rem 0;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .checkbox-list input[type="checkbox"] {
        width: 16px;
        height: 16px;
        accent-color: var(--primary);
        cursor: pointer;
      }

      .checkbox-list label {
        color: var(--gray);
        font-size: 0.9rem;
        cursor: pointer;
      }

      /* Button */
      .btn {
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.875rem 1.75rem;
        border-radius: 10px;
        font-size: 1rem;
        font-weight: 600;
        text-decoration: none;
        cursor: pointer;
        border: none;
        transition: all 0.2s;
      }

      .btn-primary {
        background: var(--gradient);
        color: white;
        box-shadow: 0 4px 14px rgba(16, 185, 129, 0.25);
      }

      .btn-primary:hover:not(:disabled) {
        transform: translateY(-1px);
        box-shadow: 0 6px 20px rgba(16, 185, 129, 0.3);
      }

      .btn-primary:disabled {
        opacity: 0.5;
        cursor: not-allowed;
      }

      .btn-secondary {
        background: white;
        color: var(--dark);
        border: 1px solid #e2e8f0;
        padding: 0.75rem 1.25rem;
        font-size: 0.95rem;
      }

      .btn-secondary:hover {
        border-color: var(--primary);
        color: var(--primary);
      }

      /* Response Section */
      .response-section {
        margin-top: 2rem;
        padding-top: 1.5rem;
        border-top: 1px solid #e2e8f0;
      }

      .response-section a {
        color: var(--primary);
        text-decoration: none;
        font-weight: 500;
      }

      .response-section a:hover {
        text-decoration: underline;
      }

      .response-section p {
        color: var(--gray);
        font-size: 0.9rem;
        margin: 0.75rem 0;
      }

      .iframe-code {
        background: var(--darker);
        color: #e2e8f0;
        padding: 1rem;
        border-radius: 8px;
        font-family: "JetBrains Mono", monospace;
        font-size: 0.85rem;
        margin: 1rem 0;
        overflow-x: auto;
      }

      .response-preview {
        margin-top: 1.5rem;
        border: 1px solid #e2e8f0;
        border-radius: 12px;
        overflow: hidden;
      }

      .response-header {
        background: #f8fafc;
        padding: 0.875rem 1rem;
        border-bottom: 1px solid #e2e8f0;
        font-size: 0.9rem;
        color: var(--gray);
        font-weight: 500;
      }

      .response-body {
        background: white;
        padding: 1rem;
      }

      .response-body iframe {
        width: 100%;
        height: 400px;
        border: none;
        border-radius: 8px;
        background: #f8fafc;
      }

      /* Coming Soon */
      .coming-soon {
        text-align: center;
        padding: 2rem;
        color: var(--gray);
        font-size: 1rem;
      }

      /* Responsive */
      @media (max-width: 768px) {
        .nav-links {
          display: none;
        }

        .page-header h1 {
          font-size: 2rem;
        }

        .flex-parent {
          grid-template-columns: 1fr;
        }
      }
    </style>
  </head>
  <body>
    <nav class="nav">
      <div class="nav-content">
        <a href="/" class="nav-logo">
          <div class="nav-logo-icon">üåç</div>
          <span class="nav-logo-text">EcoMetrics</span>
        </a>
        <div class="nav-links">
          <a href="/">Home</a>
          <a href="/api-documentation">Documentation</a>
          <a href="/querybuilder">Query Builder</a>
        </div>
      </div>
    </nav>

    <div class="container">
      <header class="page-header">
        <h1>Query Builder</h1>
        <p>Build and test API queries visually with real-time previews</p>
      </header>

      <div id="app">
        <div class="card">
          <h2 class="card-title">Build Your Query</h2>

          <div class="form-group">
            <label class="form-label">Select an API endpoint</label>
            <select v-model="dropdownSelectedAPI">
              <option disabled value="">Please select one</option>
              <option
                v-for="dropdownAPI in dropdownAPIs"
                v-bind:value="dropdownAPI[0]"
              >
                ((dropdownAPI[1]))
              </option>
            </select>
          </div>

          <div
            v-if="dropdownSelectedAPI==`table` || dropdownSelectedAPI==`json` || dropdownSelectedAPI==`graph` || dropdownSelectedAPI==`stats`"
          >
            <div class="flex-parent">
              <div class="flex-child" v-if="dropdownSelectedAPI!=`stats`">
                <p>Select at least one country</p>
                <ul class="checkbox-list">
                  <li v-for="(country, index) in countries">
                    <input
                      type="checkbox"
                      :id="'country-' + index"
                      v-model="checkedCountries[index]"
                      @click="toggleCheckedCountry(index)"
                    />
                    <label :for="'country-' + index">((country))</label>
                  </li>
                </ul>
              </div>
              <div class="flex-child" v-if="dropdownSelectedAPI!=`stats`">
                <p>Select at least one year</p>
                <ul class="checkbox-list">
                  <li v-for="(year, index) in years">
                    <input
                      type="checkbox"
                      :id="'year-' + index"
                      v-model="checkedYears[index]"
                      @click="toggleCheckedYear(index)"
                    />
                    <label :for="'year-' + index">((year))</label>
                  </li>
                </ul>
              </div>
              <div class="flex-child" v-if="dropdownSelectedAPI==`stats`">
                <p>Select a year</p>
                <select v-model="dropdownSelectedYear">
                  <option v-for="dropdownYear in years" v-bind:value="dropdownYear">
                    ((dropdownYear))
                  </option>
                </select>
              </div>
              <div
                class="flex-child"
                v-if="dropdownSelectedAPI!=`graph` && dropdownSelectedAPI!=`stats`"
              >
                <p>Select pivot</p>
                <select v-model="dropdownSelectedPivot">
                  <option
                    v-for="dropdownPivot in dropdownPivots"
                    v-bind:value="dropdownPivot"
                  >
                    ((dropdownPivot))
                  </option>
                </select>
              </div>
              <div class="flex-child" v-if="dropdownSelectedAPI==`stats`">
                <p>Number of countries</p>
                <input type="text" v-model="numberOfComparables" />
              </div>
              <div
                class="flex-child"
                v-if="dropdownSelectedAPI==`graph` || dropdownSelectedAPI==`stats`"
              >
                <p>Select theme</p>
                <select v-model="dropdownSelectedTheme">
                  <option
                    v-for="dropdownTheme in dropdownThemes"
                    v-bind:value="dropdownTheme"
                  >
                    ((dropdownTheme))
                  </option>
                </select>
              </div>
              <div class="flex-child" v-if="dropdownSelectedAPI==`graph`">
                <p>Select plot type</p>
                <select v-model="dropdownSelectedPlot">
                  <option
                    v-for="dropdownPlot in dropdownPlots"
                    v-bind:value="dropdownPlot"
                  >
                    ((dropdownPlot))
                  </option>
                </select>
              </div>
            </div>

            <div style="margin-top: 1.5rem;">
              <button
                class="btn btn-primary"
                @click="buildUrl"
                :disabled="(!checkedCountriesCount || !checkedYearsCount) && dropdownSelectedAPI!=`stats`"
              >
                Generate Response
              </button>
            </div>

            <div v-if="urlGenerated" class="response-section">
              <a target="_blank" rel="noopener" :href="finalUrl" class="btn btn-secondary">
                Open in New Tab
              </a>
              <p>This might take a while to load.</p>
              <p>Embed this response on your site using the following code:</p>
              <div class="iframe-code">
                &lt;iframe src="((finalUrl))"&gt;&lt;/iframe&gt;
              </div>
              <div class="response-preview">
                <div class="response-header">Response Preview</div>
                <div class="response-body">
                  <iframe :src="finalUrl"></iframe>
                </div>
              </div>
            </div>
          </div>

          <div v-if="dropdownSelectedAPI==`stat`" class="coming-soon">
            We will be adding this page shortly, stay tuned!
          </div>
        </div>
      </div>
    </div>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="utils/regions.js"></script>
    <script>
      const { createApp } = Vue;
      createApp({
        delimiters: ["((", "))"],
        data() {
          return {
            url: window.location.origin + "/",
            finalUrl: "/",
            dropdownAPIs: [
              ["json", "JSON Response"],
              ["table", "Table"],
              ["graph", "Graph"],
              ["stats", "Statistics"],
            ],
            dropdownSelectedAPI: "",
            dropdownPivots: ["None", "Year", "Region"],
            dropdownSelectedPivot: "None",
            countries: [
              "Afghanistan",
              "Albania",
              "Algeria",
              "Andorra",
              "Angola",
              "Antigua and Barbuda",
              "Argentina",
              "Armenia",
              "Australia",
              "Austria",
              "Azerbaijan",
              "Bahamas",
              "Bahrain",
              "Bangladesh",
              "Barbados",
              "Belarus",
              "Belgium",
              "Belize",
              "Benin",
              "Bhutan",
              "Bolivia",
              "Bosnia and Herzegovina",
              "Botswana",
              "Brazil",
              "Brunei",
              "Bulgaria",
              "Burkina Faso",
              "Burundi",
              "Cabo Verde",
              "Cambodia",
              "Cameroon",
              "Canada",
              "Central African Republic",
              "Chad",
              "Chile",
              "China",
              "Colombia",
              "Comoros",
              "Congo, Democratic Republic of the",
              "Congo, Republic of the",
              "Costa Rica",
              "Cote d'Ivoire",
              "Croatia",
              "Cuba",
              "Cyprus",
              "Czech Republic",
              "Denmark",
              "Djibouti",
              "Dominica",
              "Dominican Republic",
              "Ecuador",
              "Egypt",
              "El Salvador",
              "Equatorial Guinea",
              "Eritrea",
              "Estonia",
              "Eswatini",
              "Ethiopia",
              "Fiji",
              "Finland",
              "France",
              "Gabon",
              "Gambia",
              "Georgia",
              "Germany",
              "Ghana",
              "Greece",
              "Grenada",
              "Guatemala",
              "Guinea",
              "Guinea-Bissau",
              "Guyana",
              "Haiti",
              "Honduras",
              "Hungary",
              "Iceland",
              "India",
              "Indonesia",
              "Iran",
              "Iraq",
              "Ireland",
              "Israel",
              "Italy",
              "Jamaica",
              "Japan",
              "Jordan",
              "Kazakhstan",
              "Kenya",
              "Kiribati",
              "Korea, North",
              "Korea, South",
              "Kosovo",
              "Kuwait",
              "Kyrgyzstan",
              "Laos",
              "Latvia",
              "Lebanon",
              "Lesotho",
              "Liberia",
              "Libya",
              "Liechtenstein",
              "Lithuania",
              "Luxembourg",
              "Madagascar",
              "Malawi",
              "Malaysia",
              "Maldives",
              "Mali",
              "Malta",
              "Marshall Islands",
              "Mauritania",
              "Mauritius",
              "Mexico",
              "Micronesia",
              "Moldova",
              "Monaco",
              "Mongolia",
              "Montenegro",
              "Morocco",
              "Mozambique",
              "Myanmar",
              "Namibia",
              "Nauru",
              "Nepal",
              "Netherlands",
              "New Zealand",
              "Nicaragua",
              "Niger",
              "Nigeria",
              "North Macedonia",
              "Norway",
              "Oman",
              "Pakistan",
              "Palau",
              "Panama",
              "Papua New Guinea",
              "Paraguay",
              "Peru",
              "Philippines",
              "Poland",
              "Portugal",
              "Qatar",
              "Romania",
              "Russia",
              "Rwanda",
              "Saint Kitts and Nevis",
              "Saint Lucia",
              "Saint Vincent and the Grenadines",
              "Samoa",
              "San Marino",
              "Sao Tome and Principe",
              "Saudi Arabia",
              "Senegal",
              "Serbia",
              "Seychelles",
              "Sierra Leone",
              "Singapore",
              "Slovakia",
              "Slovenia",
              "Solomon Islands",
              "Somalia",
              "South Africa",
              "South Sudan",
              "Spain",
              "Sri Lanka",
              "Sudan",
              "Sudan, South",
              "Suriname",
              "Sweden",
              "Switzerland",
              "Syria",
              "Taiwan",
              "Tajikistan",
              "Tanzania",
              "Thailand",
              "Timor-Leste",
              "Togo",
              "Tonga",
              "Trinidad and Tobago",
              "Tunisia",
              "Turkey",
              "Turkmenistan",
              "Tuvalu",
              "Uganda",
              "Ukraine",
              "United Arab Emirates",
              "United Kingdom",
              "United States",
              "Uruguay",
              "Uzbekistan",
              "Vanuatu",
              "Vatican City",
              "Venezuela",
              "Vietnam",
              "Yemen",
              "Zambia",
              "Zimbabwe",
            ],
            checkedCountries: [],
            years: [
              1950, 1951, 1952, 1953, 1954, 1955, 1956, 1957, 1958, 1959, 1960,
              1961, 1962, 1963, 1964, 1965, 1966, 1967, 1968, 1969, 1970, 1971,
              1972, 1973, 1974, 1975, 1976, 1977, 1978, 1979, 1980, 1981, 1982,
              1983, 1984, 1985, 1986, 1987, 1988, 1989, 1990, 1991, 1992, 1993,
              1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004,
              2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015,
              2016, 2017, 2018, 2019, 2020, 2021,
            ],
            dropdownSelectedYear: 2021,
            checkedYears: [],
            checkedCountriesCount: 0,
            checkedYearsCount: 0,
            urlGenerated: false,
            dropdownThemes: [
              "none",
              "light",
              "dark",
              "fluorescent",
              "blackpink",
              "aquamarine",
            ],
            dropdownSelectedTheme: "none",
            dropdownPlots: ["scatter", "bar"],
            dropdownSelectedPlot: "scatter",
            numberOfComparables: 5,
          };
        },
        methods: {
          toggleCheckedCountry(index) {
            if (this.checkedCountries[index]) {
              this.checkedCountriesCount--;
            } else this.checkedCountriesCount++;
            this.checkedCountries[index] = !this.checkedCountries[index];
          },
          toggleCheckedYear(index) {
            if (this.checkedYears[index]) {
              this.checkedYearsCount--;
            } else this.checkedYearsCount++;
            this.checkedYears[index] = !this.checkedYears[index];
          },
          buildUrl() {
            let selectedCountries = "Region=[";
            for (let i = 0; i < this.countries.length; i++) {
              if (this.checkedCountries[i] === true) {
                selectedCountries += `%22` + this.countries[i] + `%22,`;
              }
            }
            selectedCountries = selectedCountries.substring(
              0,
              selectedCountries.length - 1
            );
            selectedCountries += `]`;
            let selectedYears = "Year=[";
            for (let i = 0; i < this.years.length; i++) {
              if (this.checkedYears[i] === true) {
                selectedYears += this.years[i] + `,`;
              }
            }
            selectedYears = selectedYears.substring(
              0,
              selectedYears.length - 1
            );
            selectedYears += `]`;
            this.finalUrl = this.url + this.dropdownSelectedAPI + "?";
            if (this.dropdownSelectedAPI != "stats")
              this.finalUrl += selectedCountries + "&" + selectedYears;
            if (this.dropdownSelectedAPI == "stats")
              this.finalUrl += "Year=" + this.dropdownSelectedYear;
            if (
              this.dropdownSelectedAPI == "json" ||
              this.dropdownSelectedAPI == "table"
            )
              this.finalUrl += "&Pivot=" + this.dropdownSelectedPivot;
            if (
              this.dropdownSelectedAPI != "json" &&
              this.dropdownSelectedAPI != "table"
            )
              this.finalUrl += "&Theme=" + this.dropdownSelectedTheme;
            if (this.dropdownSelectedAPI == "graph")
              this.finalUrl += "&Plot=" + this.dropdownSelectedPlot;
            if (this.dropdownSelectedAPI == "stats")
              this.finalUrl += "&Number=" + this.numberOfComparables;
            this.urlGenerated = true;
          },
        },
        mounted() {
          this.checkedCountries = Array(this.countries.length).fill(false);
          this.checkedYears = Array(72).fill(false);
        },
      }).mount("#app");
    </script>
  </body>
</html>
